<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reservierung anzeigen</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="reservation.css">
  <link rel="stylesheet" href="css/navigation.css">
  <link rel="stylesheet" href="css/navigation-integration.css">
</head>

<body>
  <!-- Navigation wird durch JavaScript eingefügt -->

  <main class="main-content">
    <!-- Reservation Header (grün) -->
    <div id="resHeader" class="res-header">
      <div class="header-content">
        <div class="header-info">
          <!-- Wird durch JavaScript befüllt -->
        </div>
        <div class="header-buttons">
          <button id="editBtn" class="header-btn">Bearbeiten</button>
          <button id="emailBtn" class="header-btn header-btn-blue">E-Mail</button>
          <button id="stornoBtn" class="header-btn header-btn-orange">Storno</button>
          <button id="deleteReservationBtn" class="header-btn header-btn-danger">Löschen</button>
        </div>
      </div>
    </div>

    <!-- Action Bar -->
    <div id="actionBar" class="action-bar">
      <button id="deleteBtn">Löschen</button>
      <button id="printBtn">Drucken</button>
      <button id="arrangementBtn" class="btn-arrangement">Arrangement…</button>
      <button id="dietBtn" class="btn-diet">Diät…</button>
      <button id="bulkCheckinBtn" class="btn-bulk" disabled>Bulk Check-in</button>
      <button id="bulkCheckoutBtn" class="btn-bulk" disabled>Bulk Check-out</button>
      <button id="backBtn">Zurück zur Liste</button>
    </div>

    <!-- Namen-Tabelle -->
    <div class="table-container">
      <table id="namesTable" class="names-list">
        <thead>
          <tr>
            <th><input type="checkbox" id="selectAll"></th>
            <th>Name</th>
            <th>Details</th>
            <th>Alter</th>
            <th>Bemerkung</th>
            <th>BF</th>
            <th>Arr</th>
            <th>Diät</th>
            <th>No-Show</th>
            <th>Check-in</th>
            <th>Check-out</th>
          </tr>
        </thead>
        <tbody>
          <!-- Wird durch JavaScript befüllt -->
        </tbody>
      </table>
    </div>

    <!-- Arrangement Modal -->
    <div id="arrangementModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <span id="closeArrModal" class="modal-close">&times;</span>
        <h2>Arrangement wählen</h2>
        <div id="arrButtonsContainer" class="arr-buttons"></div>
      </div>
    </div>

    <!-- Diet Modal -->
    <div id="dietModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <span id="closeDietModal" class="modal-close">&times;</span>
        <h2>Diät wählen</h2>
        <div id="dietButtonsContainer" class="arr-buttons"></div>
      </div>
    </div>

    <!-- Namen hinzufügen -->
    <details id="addNamesDetails">
      <summary>Namen hinzufügen</summary>
      <div class="import-format-selector">
        <label for="importFormat">Format:</label>
        <select id="importFormat">
          <option value="firstname-lastname">Vorname Nachname</option>
          <option value="lastname-firstname">Nachname Vorname</option>
        </select>
      </div>
      <textarea id="newNamesTextarea" rows="5" placeholder="pro Zeile ein Eintrag"></textarea>
      <button id="importNamesBtn">Importieren</button>
    </details>

    <!-- Custom Confirmation Modal -->
    <div id="confirmModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <span class="modal-close" id="confirmModalClose">&times;</span>
        <h3 id="confirmModalTitle">Bestätigung</h3>
        <div id="confirmModalMessage"></div>
        <div id="confirmModalQuestion"></div>
        <div class="modal-buttons">
          <button id="confirmModalYes" class="btn-confirm">Ja</button>
          <button id="confirmModalNo" class="btn-cancel">Nein</button>
        </div>
      </div>
    </div>

    <!-- Name Correction Modal -->
    <div id="nameCorrectionModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <span class="modal-close" id="nameCorrectionModalClose">&times;</span>
        <h3>Namen-Korrektur vorgeschlagen</h3>
        <p>Es wurde erkannt, dass in einem Namensfeld mehrere Namen stehen. Möchten Sie diese aufteilen?</p>

        <div id="nameCorrectionOptions" style="margin: 20px 0;">
          <!-- Options will be populated by JavaScript -->
        </div>

        <div style="margin: 15px 0;">
          <label for="customNameSplit" style="display: block; margin-bottom: 5px; font-weight: 600;">Eigene
            Aufteilung:</label>
          <div style="display: flex; gap: 10px; align-items: center;">
            <div>
              <label for="customVorname" style="font-size: 0.9rem;">VN:</label>
              <input type="text" id="customVorname" placeholder="Vorname"
                style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 120px;">
            </div>
            <div>
              <label for="customNachname" style="font-size: 0.9rem;">NN:</label>
              <input type="text" id="customNachname" placeholder="Nachname"
                style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 120px;">
            </div>
          </div>
        </div>

        <div class="modal-buttons">
          <button id="nameCorrectionApply" class="btn-confirm">Anwenden</button>
          <button id="nameCorrectionSkip" class="btn-cancel">Überspringen</button>
        </div>
      </div>
    </div>
  </main>

  <!-- Connection Status -->
  <div class="connection-status" id="connection-indicator">
    <div class="status-dot"></div>
    <span class="status-text">Verbindung prüfen...</span>
  </div>

  <!-- Navigation System -->
  <script src="js/navigation.js"></script>
  <script src="js/email-utils.js"></script>
  <script src="js/http-utils.js"></script>
  <script src="js/loading-overlay.js"></script>
  <script src="reservation.js"></script>

  <script>
    // Navigation und Initialisierung
    document.addEventListener('DOMContentLoaded', function () {
      // Navigation Setup
      if (typeof NavigationSystem !== 'undefined') {
        NavigationSystem.setupNavigation();
        console.log('✅ Navigation setup completed');
      } else {
        console.warn('⚠️ NavigationSystem not found');
      }

      // Connection Status
      const indicator = document.getElementById('connection-indicator');
      if (indicator && window.connectionMonitor && window.updateConnectionStatus) {
        window.updateConnectionStatus();
      }

      console.log('✅ Reservation page initialized');
    });
  </script>
</body>

</html>